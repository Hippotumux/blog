"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[303],{6262:(s,a)=>{a.A=(s,a)=>{const n=s.__vccOpts||s;for(const[s,p]of a)n[s]=p;return n}},9808:(s,a,n)=>{n.r(a),n.d(a,{comp:()=>m,data:()=>e});var p=n(641);const t={},m=(0,n(6262).A)(t,[["render",function(s,a){return(0,p.uX)(),(0,p.CE)("div",null,[a[0]||(a[0]=(0,p.Lk)("p",null,"Q learning 為一種強化學習。",-1)),a[1]||(a[1]=(0,p.Lk)("h2",{id:"強化學習",tabindex:"-1"},[(0,p.Lk)("a",{class:"header-anchor",href:"#強化學習"},[(0,p.Lk)("span",null,"強化學習")])],-1)),a[2]||(a[2]=(0,p.Lk)("p",null,'"強化學習"，並非指學習很強，而是指一步一步慢慢增"強"的學習法。',-1)),a[3]||(a[3]=(0,p.Lk)("p",null,"RL為透過「跟世界的互動」來學習的，不像監督式學習，已經有人告訴他答案，RL 沒有，RL 必須要自己先去做做看，然後這個世界回饋給他的也不是正確答案，世界回饋給他的只有分數，做了這個動作得了幾分之類的。",-1)),(0,p.Q3)(" more "),a[4]||(a[4]=(0,p.Fv)('<p>Richard S. Sutton 給出的定義為： “Reinforcement learning is learning what to do—how to map situations to actions—to maximize a numerical reward signal.</p><p>RL主要的算法有</p><ul><li>Q learning</li><li>Sarsa</li><li>Policy Gradients</li><li>Actor-Critic</li><li>Monte-carlo learning</li><li>Deep-Q-Network</li></ul><h2 id="基礎名稱定義" tabindex="-1"><a class="header-anchor" href="#基礎名稱定義"><span>基礎名稱定義</span></a></h2><ul><li>agent代理</li><li>enritonment環境</li><li>state狀態</li><li>action動作</li><li>reward獎勵</li><li>value function價值函數</li></ul><p>舉個例子<br> 學生代表agent代理，升學和考試機制就代表著環境，考試題目代表著狀態，每次學生的考試作答(動作)，會得到一個成績(獎勵)，所以我們要根據得到的成績去做出最好的解題方式(RL目的)</p><h2 id="定義" tabindex="-1"><a class="header-anchor" href="#定義"><span>定義</span></a></h2><p>Q Learning 是一種無模型的強化學習算法，在基於價值的強化學習中，目標是優化一個價值函數，一個將最大未來獎勵映射到給定狀態的函數（可以被認為是一個簡單的查找表）。每個狀態的值是 RL 代理在實現目標之前可以期望獲得的獎勵總額。</p><h2 id="算法思想" tabindex="-1"><a class="header-anchor" href="#算法思想"><span>算法思想</span></a></h2><p>Q Learning是以value-based的算法，Q 即為 Q(s,a)，就是在某個s狀態下，採取了動作a，能夠獲得的收益期望，環境會根據 agent 的動作反饋回報 reward r，所以算法主要思想就是將 State 與 Action 建構一張 Q-table 來儲存Q值，然後根據Q值來選取能夠獲得收益的動作。</p><h3 id="更新公式" tabindex="-1"><a class="header-anchor" href="#更新公式"><span>更新公式</span></a></h3><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>Q</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo stretchy="false">)</mo><mspace></mspace><mspace width="0.1111em"></mspace><mo lspace="0em" rspace="0.17em"></mo><mtext> ⁣</mtext><mo lspace="0em" rspace="0em">:</mo><mspace width="0.3333em"></mspace><mo>=</mo><mi>Q</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo stretchy="false">)</mo><mo>+</mo><mi>α</mi><mo stretchy="false">(</mo><mi>r</mi><mo>+</mo><mi>γ</mi><mi>m</mi><mi>a</mi><mi>x</mi><mi>Q</mi><mo stretchy="false">(</mo><msup><mi>s</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo separator="true">,</mo><msup><mi>a</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">)</mo><mo>−</mo><mi>Q</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Q(s,a)\\colon=Q(s,a) + \\alpha(r + \\gamma maxQ(s&#39;,a&#39;) - Q(s,a)) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mspace nobreak"></span><span class="mspace" style="margin-right:0.1111em;"></span><span class="mpunct"></span><span class="mspace" style="margin-right:-0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mrel">:</span></span><span class="mspace" style="margin-right:0.3333em;"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0519em;vertical-align:-0.25em;"></span><span class="mord mathnormal">γma</span><span class="mord mathnormal">x</span><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mclose">))</span></span></span></span></span></p><ul><li>Q(s,a) 在s狀態執行a動作的價值</li><li>α 學習率</li><li>r 獎勵 (可能有正有負)</li><li>γ 衰變值</li></ul><p>(會發現 Q-table 很大，所以狀態不能把全部環境丟進去，只能擷取一小部分)</p><p>另外這和馬可夫決策有一點點不同</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>q</mi><mo>∗</mo></msub><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo stretchy="false">)</mo><mo>=</mo><msubsup><mi>R</mi><mi>s</mi><mi>a</mi></msubsup><mo>+</mo><mi>γ</mi><munder><mo>∑</mo><mrow><msup><mi>s</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>∈</mo><mi>S</mi></mrow></munder><msubsup><mi>P</mi><mrow><mi>s</mi><mo separator="true">,</mo><msup><mi>s</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><mi>a</mi></msubsup><mtext> </mtext><mi>m</mi><mi>a</mi><mi>x</mi><mtext> </mtext><msubsup><mi>q</mi><mo>∗</mo><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mo stretchy="false">(</mo><msup><mi>s</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo separator="true">,</mo><msup><mi>a</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">q_*(s,a) = R_s^a + \\gamma \\sum_{s&#39;\\in S}P^a_{s,s&#39;}\\space max \\space q&#39;_*(s&#39;,a&#39;) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1757em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9614em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-2.453em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.3717em;vertical-align:-1.3217em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8557em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mrel mtight">∈</span><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3217em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em;"><span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathnormal">ma</span><span class="mord mathnormal">x</span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-2.453em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>馬可夫決策是全域，所以需要對於所有可能的 s&#39; 進行期望計算，而 QL 則是基於 &quot;單步經驗樣本更新&quot;，是直接針對當前去估算。</p><h2 id="應用-貪吃蛇" tabindex="-1"><a class="header-anchor" href="#應用-貪吃蛇"><span>應用 (貪吃蛇)</span></a></h2><h3 id="貪吃蛇是什麼" tabindex="-1"><a class="header-anchor" href="#貪吃蛇是什麼"><span>貪吃蛇是什麼？</span></a></h3><ul><li>在遊戲中，玩家操控一條細長的直線（俗稱蛇）</li><li>玩家只能操控蛇的頭部朝向（上下左右）</li><li>路上會有很多&quot;食物&quot;</li><li>每次貪食蛇吃掉一件食物，它的身體便增長一些</li><li>不能碰觸到牆壁跟自身的身體</li><li>目的: 讓自己的身體越長越好</li></ul><h3 id="環境規劃" tabindex="-1"><a class="header-anchor" href="#環境規劃"><span>環境規劃</span></a></h3><ul><li>簡單化(處理資料比較方便，效率比較好)</li><li>12*12</li><li>蛇身藍色</li><li>蛇頭綠色</li><li>食物紅色</li><li>背景白色</li></ul><figure><img src="https://hackmd.io/_uploads/rJ-KnVcNh.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="流程" tabindex="-1"><a class="header-anchor" href="#流程"><span>流程</span></a></h2><h3 id="貪食蛇移動" tabindex="-1"><a class="header-anchor" href="#貪食蛇移動"><span>貪食蛇移動</span></a></h3><ul><li>定義前後左右為 0右 1左 2下 3上</li><li>頭移動到下一個位置，其餘位置替換成前面</li></ul><h3 id="貪食蛇吃到食物" tabindex="-1"><a class="header-anchor" href="#貪食蛇吃到食物"><span>貪食蛇吃到食物</span></a></h3><ul><li>身體不動，把頭換成食物的位置</li><li>讓食物隨機出生(不要碰到蛇)</li></ul><h3 id="死亡條件" tabindex="-1"><a class="header-anchor" href="#死亡條件"><span>死亡條件</span></a></h3><ul><li>頭的位置碰到自己的身體</li><li>頭的位置碰到牆壁</li></ul><h3 id="qtable" tabindex="-1"><a class="header-anchor" href="#qtable"><span>Qtable</span></a></h3><p>Qtable[(x,y),(l,r,u,d)] = [右, 左 ,下 ,上]</p><h3 id="設定reward" tabindex="-1"><a class="header-anchor" href="#設定reward"><span>設定reward</span></a></h3><ul><li>撞到身體(-150)</li><li>撞到牆壁(-150)</li><li>拿到獎勵(200)</li><li>每走一步(-1)</li></ul><h3 id="更新-qtable" tabindex="-1"><a class="header-anchor" href="#更新-qtable"><span>更新 Qtable</span></a></h3><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>Q</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo stretchy="false">)</mo><mspace></mspace><mspace width="0.1111em"></mspace><mo lspace="0em" rspace="0.17em"></mo><mtext> ⁣</mtext><mo lspace="0em" rspace="0em">:</mo><mspace width="0.3333em"></mspace><mo>=</mo><mi>Q</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo stretchy="false">)</mo><mo>+</mo><mi>α</mi><mo stretchy="false">(</mo><mi>r</mi><mo>+</mo><mi>γ</mi><mi>m</mi><mi>a</mi><mi>x</mi><mi>Q</mi><mo stretchy="false">(</mo><msup><mi>s</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo separator="true">,</mo><msup><mi>a</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">)</mo><mo>−</mo><mi>Q</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Q(s,a) \\colon= Q(s,a) + \\alpha(r + \\gamma maxQ(s&#39;,a&#39;) - Q(s,a)) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mspace nobreak"></span><span class="mspace" style="margin-right:0.1111em;"></span><span class="mpunct"></span><span class="mspace" style="margin-right:-0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mrel">:</span></span><span class="mspace" style="margin-right:0.3333em;"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0519em;vertical-align:-0.25em;"></span><span class="mord mathnormal">γma</span><span class="mord mathnormal">x</span><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mclose">))</span></span></span></span></span></p><p>只需要根據當前的state，查詢Qtable 例如: 當前的state為[(1,2),(0,0,0,1)] 也就是和食物距離 (1,2) 並且上面有障礙物，所以查詢Qtable，會得到選擇[右, 左 ,下 ,上]的值，只要選擇最大值即為當前最好的選擇。</p><p>最後依照公式更改 Qtable</p><p>結果</p><figure><img src="https://hackmd.io/_uploads/SJxByRmQJl.png" alt="image" tabindex="0" loading="lazy"><figcaption>image</figcaption></figure><h2 id="deep-q-network" tabindex="-1"><a class="header-anchor" href="#deep-q-network"><span>Deep-Q-Network</span></a></h2><p>Deep Q-Network (DQN) 是一種強化學習演算法，它結合了 Q-Learning 和 深度神經網路，用於解決狀態空間非常大或連續的問題。DQN 的誕生解決了表格型 Q-Learning 無法應對高維度問題的限制。</p><h3 id="核心" tabindex="-1"><a class="header-anchor" href="#核心"><span>核心</span></a></h3><p>在 Q-Learning 中，我們學習的是狀態-行動價值函數 Q(s, a)，但是，當狀態空間非常大時，表格形式無法處理。因此，DQN 使用 MLP 來逼近 Q(s, a)</p><h3 id="流程-1" tabindex="-1"><a class="header-anchor" href="#流程-1"><span>流程</span></a></h3><ol><li>初始化 Q Network: Q(s, a; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span></span>)</li><li>loss: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>=</mo><mi>E</mi><mo stretchy="false">[</mo><mo stretchy="false">(</mo><mi>y</mi><mo>−</mo><mi>Q</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo separator="true">;</mo><mi>θ</mi><mo stretchy="false">)</mo><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">L(\\theta) = E[(y-Q(s, a; \\theta))^2]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mopen">[(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span><br> 其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mi>r</mi><mo>+</mo><mi>γ</mi><mi>m</mi><mi>a</mi><mi>x</mi><mi>Q</mi><mo stretchy="false">(</mo><msup><mi>s</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo separator="true">,</mo><msup><mi>a</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo separator="true">,</mo><msup><mi>θ</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">y = r + \\gamma max Q(s&#39;, a&#39;, \\theta&#39;)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0019em;vertical-align:-0.25em;"></span><span class="mord mathnormal">γma</span><span class="mord mathnormal">x</span><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li></ol><h3 id="實作" tabindex="-1"><a class="header-anchor" href="#實作"><span>實作</span></a></h3><p>除了貪吃蛇的上下左右外，我還放了與食物 x 差距 y 貪吃蛇長度，跟上下左右共 7 個 state</p><p>Network : 7 -&gt; 128 -&gt; 128 -&gt; 4</p><figure><img src="https://hackmd.io/_uploads/SytF4CQXyg.png" alt="image" tabindex="0" loading="lazy"><figcaption>image</figcaption></figure><h1 style="color:gray;">參考資料</h1><p><a href="https://blog.csdn.net/qq_30615903/article/details/80739243" target="_blank" rel="noopener noreferrer">&lt;強化學習&gt;Q learning算法詳解</a></p>',52))])}]]),e=JSON.parse('{"path":"/Posts/RL/QL_snake.html","title":"QL 貪吃蛇實作","lang":"en-US","frontmatter":{"title":"QL 貪吃蛇實作","order":2,"date":"2023-08-19T00:00:00.000Z","category":["ML"],"tag":["python","Imp"],"description":"Q learning 為一種強化學習。 強化學習 \\"強化學習\\"，並非指學習很強，而是指一步一步慢慢增\\"強\\"的學習法。 RL為透過「跟世界的互動」來學習的，不像監督式學習，已經有人告訴他答案，RL 沒有，RL 必須要自己先去做做看，然後這個世界回饋給他的也不是正確答案，世界回饋給他的只有分數，做了這個動作得了幾分之類的。","head":[["meta",{"property":"og:url","content":"https://hippotumux.github.io/blog/blog/Posts/RL/QL_snake.html"}],["meta",{"property":"og:site_name","content":"Hippotumux\'s Blog"}],["meta",{"property":"og:title","content":"QL 貪吃蛇實作"}],["meta",{"property":"og:description","content":"Q learning 為一種強化學習。 強化學習 \\"強化學習\\"，並非指學習很強，而是指一步一步慢慢增\\"強\\"的學習法。 RL為透過「跟世界的互動」來學習的，不像監督式學習，已經有人告訴他答案，RL 沒有，RL 必須要自己先去做做看，然後這個世界回饋給他的也不是正確答案，世界回饋給他的只有分數，做了這個動作得了幾分之類的。"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://hackmd.io/_uploads/rJ-KnVcNh.png"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2025-02-22T17:39:28.000Z"}],["meta",{"property":"article:tag","content":"python"}],["meta",{"property":"article:tag","content":"Imp"}],["meta",{"property":"article:published_time","content":"2023-08-19T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2025-02-22T17:39:28.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"QL 貪吃蛇實作\\",\\"image\\":[\\"https://hackmd.io/_uploads/rJ-KnVcNh.png\\",\\"https://hackmd.io/_uploads/SJxByRmQJl.png\\",\\"https://hackmd.io/_uploads/SytF4CQXyg.png\\"],\\"datePublished\\":\\"2023-08-19T00:00:00.000Z\\",\\"dateModified\\":\\"2025-02-22T17:39:28.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Hippotumux\\",\\"url\\":\\"https://hippotumux.github.io/blog/\\"}]}"]]},"headers":[{"level":2,"title":"強化學習","slug":"強化學習","link":"#強化學習","children":[]},{"level":2,"title":"基礎名稱定義","slug":"基礎名稱定義","link":"#基礎名稱定義","children":[]},{"level":2,"title":"定義","slug":"定義","link":"#定義","children":[]},{"level":2,"title":"算法思想","slug":"算法思想","link":"#算法思想","children":[{"level":3,"title":"更新公式","slug":"更新公式","link":"#更新公式","children":[]}]},{"level":2,"title":"應用 (貪吃蛇)","slug":"應用-貪吃蛇","link":"#應用-貪吃蛇","children":[{"level":3,"title":"貪吃蛇是什麼？","slug":"貪吃蛇是什麼","link":"#貪吃蛇是什麼","children":[]},{"level":3,"title":"環境規劃","slug":"環境規劃","link":"#環境規劃","children":[]}]},{"level":2,"title":"流程","slug":"流程","link":"#流程","children":[{"level":3,"title":"貪食蛇移動","slug":"貪食蛇移動","link":"#貪食蛇移動","children":[]},{"level":3,"title":"貪食蛇吃到食物","slug":"貪食蛇吃到食物","link":"#貪食蛇吃到食物","children":[]},{"level":3,"title":"死亡條件","slug":"死亡條件","link":"#死亡條件","children":[]},{"level":3,"title":"Qtable","slug":"qtable","link":"#qtable","children":[]},{"level":3,"title":"設定reward","slug":"設定reward","link":"#設定reward","children":[]},{"level":3,"title":"更新 Qtable","slug":"更新-qtable","link":"#更新-qtable","children":[]}]},{"level":2,"title":"Deep-Q-Network","slug":"deep-q-network","link":"#deep-q-network","children":[{"level":3,"title":"核心","slug":"核心","link":"#核心","children":[]},{"level":3,"title":"流程","slug":"流程-1","link":"#流程-1","children":[]},{"level":3,"title":"實作","slug":"實作","link":"#實作","children":[]}]}],"git":{"createdTime":1740245968000,"updatedTime":1740245968000,"contributors":[{"name":"hippotumux","username":"hippotumux","email":"st6805972@gmail.com","commits":1,"url":"https://github.com/hippotumux"}]},"readingTime":{"minutes":4.24,"words":1271},"filePathRelative":"Posts/RL/QL_snake.md","localizedDate":"August 19, 2023","excerpt":"<p>Q learning 為一種強化學習。</p>\\n<h2>強化學習</h2>\\n<p>\\"強化學習\\"，並非指學習很強，而是指一步一步慢慢增\\"強\\"的學習法。</p>\\n<p>RL為透過「跟世界的互動」來學習的，不像監督式學習，已經有人告訴他答案，RL 沒有，RL 必須要自己先去做做看，然後這個世界回饋給他的也不是正確答案，世界回饋給他的只有分數，做了這個動作得了幾分之類的。</p>\\n","autoDesc":true}')}}]);